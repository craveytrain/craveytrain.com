---
phase: 01-now-page-system
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - site/now/index.md
  - layouts/page.njk
  - layouts/base.njk
  - includes/css/index.css
autonomous: true
gap_closure: true

must_haves:
  truths:
    - 'Now link appears in site footer navigation (not header)'
    - 'Now page prev/next navigation displays as styled horizontal links'
    - 'Page title displays correctly without escaped special characters'
  artifacts:
    - path: 'site/now/index.md'
      provides: 'Now page with foot tag for footer navigation'
      contains: 'tags: foot'
    - path: 'layouts/page.njk'
      provides: 'Page layout without header navigation'
    - path: 'layouts/base.njk'
      provides: 'Title without double escaping'
      contains: '| safe'
    - path: 'includes/css/index.css'
      provides: 'Styles for .now-nav component'
      contains: '.now-nav'
  key_links:
    - from: 'site/now/index.md'
      to: 'collections.foot'
      via: 'tags: foot frontmatter'
      pattern: "tags:\\s*foot"
---

<objective>
Fix three UAT-diagnosed gaps in the now page system: move Now link to footer navigation, style prev/next navigation, and fix title escaping.

Purpose: Address user-reported issues from UAT testing to complete Phase 1 properly.
Output: Now page renders correctly with footer nav, styled prev/next links, and clean browser title.
</objective>

<execution_context>
@/Users/mcravey/.claude/get-shit-done/workflows/execute-plan.md
@/Users/mcravey/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-now-page-system/01-UAT.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix navigation location</name>
  <files>site/now/index.md, layouts/page.njk</files>
  <action>
  1. In site/now/index.md, change `tags: nav` to `tags: foot` so the Now link appears in footer navigation instead of header.

2. In layouts/page.njk, remove the entire header nav section (lines 7-16):
   ```
   <nav>
       <ul>
           {% for entry in collections.nav | eleventyNavigation %}
               {% set url = entry.url %}
               {% set contents = entry.key %}
               <li>{% include 'nav-item.njk' %}</li>
           {% endfor %}
       </ul>
   </nav>
   ```

The site uses footer navigation only (see base.njk lines 88-97). The header nav in page.njk was incorrectly added and should be removed.
</action>
<verify>

- Run `npm run build` - build succeeds
- Check site/now/index.md contains `tags: foot`
- Check layouts/page.njk has no `<nav>` element
  </verify>
  <done>Now link appears in footer navigation, header nav removed from page layout</done>
  </task>

<task type="auto">
  <name>Task 2: Style now-nav component</name>
  <files>includes/css/index.css</files>
  <action>
  Add CSS for the .now-nav component at the end of includes/css/index.css:

```css
/* Now page navigation */
.now-nav ul {
	display: flex;
	justify-content: space-between;
	list-style: none;
}

.now-nav li:only-child:last-child {
	margin-left: auto;
}
```

This styles the prev/next links as a horizontal row with Previous on left and Next on right. The :only-child:last-child rule handles the case where only "Next" exists (no previous page) - pushes it to the right.
</action>
<verify>

- Run `npm run build` - build succeeds
- Check includes/css/index.css contains `.now-nav ul`
  </verify>
  <done>Now page prev/next navigation styled as horizontal links</done>
  </task>

<task type="auto">
  <name>Task 3: Fix title escaping</name>
  <files>layouts/base.njk</files>
  <action>
  In layouts/base.njk, fix the double-escaping issue in the pageTitle set block (lines 1-7).

Change from:

```
{% set pageTitle %}
    {% if title %}
        {{ title }} - craveytrain.com
    {% else %}
        Craveytrain
    {% endif %}
{% endset %}
```

To:

```
{% set pageTitle %}
    {% if title %}
        {{ title | safe }} - craveytrain.com
    {% else %}
        Craveytrain
    {% endif %}
{% endset %}
```

The issue: When title contains special characters (like fancy apostrophe), the set block escapes them, then {{ pageTitle }} in the title tag escapes again, resulting in visible HTML entities in the browser tab.

Adding `| safe` to title inside the set block prevents double escaping.
</action>
<verify>

- Run `npm run build` - build succeeds
- Check layouts/base.njk contains `{{ title | safe }}`
  </verify>
  <done>Page titles display special characters correctly without HTML entity escaping</done>
  </task>

</tasks>

<verification>
After all tasks:
1. `npm run build` completes without errors
2. `npm run serve` and verify:
   - Now link appears in footer navigation (not header)
   - Visit /now/ - prev/next links styled horizontally
   - Browser tab shows clean title without escaped characters
</verification>

<success_criteria>

- Now link in footer navigation, not header
- Prev/next navigation styled as horizontal flex row
- Page titles render special characters correctly
- All existing functionality preserved
  </success_criteria>

<output>
After completion, create `.planning/phases/01-now-page-system/01-03-SUMMARY.md`
</output>
